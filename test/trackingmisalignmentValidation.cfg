process TkVal = 
{
  untracked PSet maxEvents = {untracked int32 input = NEVENT}

  include "FWCore/MessageService/data/MessageLogger.cfi"

  include "Configuration/StandardSequences/data/Reconstruction.cff"
  #include "Configuration/StandardSequences/data/Simulation.cff"
#  include "Configuration/StandardSequences/data/Services.cff" 
  #include "Configuration/StandardSequences/data/RawToDigi.cff"
  #include "Configuration/StandardSequences/data/MixingNoPileUp.cff" 

  ##include "Configuration/StandardSequences/data/FakeConditions.cff"
  include "Configuration/StandardSequences/data/FrontierConditions_GlobalTag.cff" 
  replace GlobalTag.globaltag = "SCENARIO::All" 

  ### for the validator 
  # Track Associators
  include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"
  include "SimTracker/TrackAssociation/data/TrackAssociatorByHits.cfi"

  include "Validation/RecoTrack/data/cuts.cff"
  include "Validation/RecoTrack/data/cutsTPEffic.cfi"
  include "Validation/RecoTrack/data/cutsTPFake.cfi"
  include "Validation/RecoTrack/data/MultiTrackValidator.cff"


  source = PoolSource 
  { 
    untracked vstring fileNames = {'file:input.root'}
  }


  ##############################
  #replace MessageLogger.cout.placeholder = false
  #module pts = PathTimerInserter{}
  #service = PathTimerService{}
  service = Timing{}
  include "Validation/RecoTrack/test/SAMPLE.cff"

  ### merging
  #module mergedTracks = TrackMerger {
  #   VInputTag src = { "firstvtxFilt:","secondvtxFilt:",
  #                     "thirdvtxFilt:","fourthvtxFilt:" }
  #}


  ### validation
  replace multiTrackValidator.out = "val.SAMPLE.root"	
  replace multiTrackValidator.associators = {"TrackAssociatorByHits"}
  replace multiTrackValidator.label = {generalTracks}
  #replace multiTrackValidator.UseAssociators = true

  ###############################


  module out = PoolOutputModule 
  {
    untracked string fileName = 'output.SAMPLE.root'
    untracked vstring outputCommands = 
      {
        "drop *",
        #"keep *_g4SimHits_TrackerHits*_*",
        #"keep SimVertexs_g4SimHits_*_*",
        #"keep SimTracks_g4SimHits_*_*",
        #"keep *_trackingtruthprod_*_*",
        #"keep PixelDigiSimLink*_*_*_*",
        #"keep StripDigiSimLink*_*_*_*",
        #"keep *_siPixelClusters_*_*",
        #"keep *_siStripClusters_*_*",
        #"keep *_cmsTracks_*_*",
        #"keep *_pixelVertices_*_*",
        #"keep recoTracks_pixelTracks_*_*",
        #"keep *_ctfWithMaterialTracks_*_*",
        "keep HLTPerformanceInfo_*_*_*"
      }
  }      

  sequence digi2track =   {
   siPixelClusters,siPixelRecHits, siStripClusters,siStripMatchedRecHits,
   newTracking,
   cutsTPEffic,cutsTPFake,
   multiTrackValidator
   #,pts
  }


  sequence re_tracking =   {
   ##globalMixedSeeds,ckfTrackCandidates,ctfWithMaterialTracks,cutsCKF,
   ##siPixelDigis,SiStripRawToDigis,
   siPixelRecHits,siStripMatchedRecHits,
   newTracking,
   cutsTPEffic,cutsTPFake,
   multiTrackValidator
   #,pts
  }

 
  include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi"
  include "SimGeneral/MixingModule/data/mixNoPU.cfi"

  sequence only_validation = {
   cutsTPEffic,cutsTPFake,
   multiTrackValidator
  }
                     
  path p = {
   SEQUENCE	
  }


#  endpath e = 
#  {
#    out
#  }
}
